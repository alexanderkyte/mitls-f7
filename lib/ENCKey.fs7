module ENCKey

open Bytes
open TLSInfo
open CipherSuites

private type (;ki:KeyInfo) key = {k:bytes}

type iv = bytes
type (;ki:KeyInfo) iv3 =
	| SomeIV of iv // SSL_3p0 and TLS_1p0
	| NoIV of bool // TLS_1p0 and TLS_1p2

val GEN: ki:KeyInfo -> (;ki)key
val LEAK:   ki:KeyInfo{Corrupt(ki)} -> (;ki)key -> bytes
val COERCE: ki:KeyInfo{Corrupt(ki)} -> bytes -> (;ki)key
