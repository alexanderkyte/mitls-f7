module MACKey

open Bytes
open TLSInfo

private type (;ki:KeyInfo) key = {k:bytes}

val GEN: ki:KeyInfo -> (;ki) key
val LEAK:   ki:KeyInfo{Corrupt(ki)} -> (;ki)key -> bytes
val COERCE: ki:KeyInfo{Corrupt(ki)} -> bytes -> (;ki)key

val reIndex: oldKI:KeyInfo{NullSessionInfo(oldKI.sinfo)} ->
	newKI:KeyInfo{NullSessionInfo(newKI.sinfo)} ->
	(;oldKI)key -> (;newKI)key